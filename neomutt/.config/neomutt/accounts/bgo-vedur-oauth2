# Microsoft 365 OAuth2 account configuration for bgo@vedur.is
# Uses XOAUTH2 authentication instead of password

# Account settings
set realname = "Benedikt Gunnar Ã“feigsson"
set from = "bgo@vedur.is"
set imap_user = "bgo@vedur.is"

# OAuth2 authentication
set imap_authenticators = "xoauth2"
set imap_oauth_refresh_command = "~/.config/neomutt/scripts/oauth2-ms.py --token"

# Server settings - Microsoft 365/Outlook
set folder = "imaps://outlook.office365.com:993/"
set spoolfile = "+INBOX"
set record = "+Sent Items"  # Microsoft uses "Sent Items" not "Sent"
set trash = "+Deleted Items"  # Microsoft uses "Deleted Items"
set postponed = "+Drafts"

# SMTP settings with OAuth2
set smtp_url = "smtps://bgo@vedur.is@smtp.office365.com:587/"
set smtp_authenticators = "xoauth2"
set smtp_oauth_refresh_command = "~/.config/neomutt/scripts/oauth2-ms.py --token"

# SSL settings
set ssl_force_tls = yes
set ssl_starttls = yes

# Microsoft-specific settings
set imap_check_subscribed = yes
set imap_list_subscribed = yes