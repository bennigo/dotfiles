all:
  hosts:
    localhost:
      ansible_connection: local
      ansible_become_password: "{{ ansible_sudo_pass }}"
  vars:
    # Hardware detection will be populated by gather_facts
    # These can be overridden via command line or host_vars/
    
    # Hardware flags (auto-detected or manually set)
    has_nvidia_gpu: "{{ ansible_facts['devices'] | dict2items | selectattr('value.model', 'match', '.*NVIDIA.*') | list | length > 0 if ansible_facts is defined else false }}"
    has_intel_gpu: "{{ ansible_facts['processor'] | select('match', '.*Intel.*') | list | length > 0 if ansible_facts is defined else false }}"
    has_amd_gpu: "{{ ansible_facts['devices'] | dict2items | selectattr('value.model', 'match', '.*AMD.*') | list | length > 0 if ansible_facts is defined else false }}"
    
    # System type detection
    is_laptop: "{{ ansible_facts['form_factor'] == 'Laptop' or ansible_facts['chassis'] == 'laptop' if ansible_facts is defined else false }}"
    is_desktop: "{{ not is_laptop }}"
    has_battery: "{{ ansible_facts['power_supplies'] | selectattr('type', 'equalto', 'Battery') | list | length > 0 if ansible_facts is defined else false }}"
    
    # Manual overrides (set these in host_vars/ or command line)
    # force_nvidia: false
    # force_laptop: false
    # skip_hardware_specific: false