all:
  hosts:
    localhost:
      ansible_connection: local
  vars:
    # Hardware detection - with safe defaults
    # These can be overridden via command line: --extra-vars "force_nvidia=true"

    # Hardware flags (auto-detected with fallback to false)
    has_nvidia_gpu: "{{ (ansible_facts.get('devices', {}) | dict2items | selectattr('value.model', 'defined') | selectattr('value.model', 'match', '.*NVIDIA.*') | list | length > 0) | default(false) }}"
    has_intel_gpu: "{{ (ansible_facts.get('processor', []) | select('match', '.*Intel.*') | list | length > 0) | default(false) }}"
    has_amd_gpu: "{{ (ansible_facts.get('devices', {}) | dict2items | selectattr('value.model', 'defined') | selectattr('value.model', 'match', '.*AMD.*') | list | length > 0) | default(false) }}"

    # System type detection
    is_laptop: "{{ ansible_facts.get('form_factor', '') == 'Laptop' or ansible_facts.get('system_vendor', '') | lower in ['lenovo', 'dell', 'hp', 'asus', 'acer', 'toshiba', 'sony', 'samsung'] | default(false) }}"
    is_desktop: "{{ not (is_laptop | default(false)) }}"
    has_battery: "{{ (ansible_facts.get('power_supplies', []) | selectattr('type', 'defined') | selectattr('type', 'equalto', 'Battery') | list | length > 0) | default(false) }}"

    
    # Manual overrides (set these in host_vars/ or command line)
    # force_nvidia: false
    # force_laptop: false
    # skip_hardware_specific: false
